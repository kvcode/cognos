// Find the PreLoad instance through the DOM
console.log("=== Finding PreLoad Instance ===");

// Get the custom control container
var container = document.querySelector('[specname="customControl"]');
console.log("Custom control container:", container);

// Cognos stores control instances on DOM elements
// Try different property names Cognos uses
if (container) {
  console.log("Container properties:", Object.keys(container));
  
  // Check for control reference
  for (var key in container) {
    if (key.startsWith('_') || key.includes('control') || key.includes('instance')) {
      console.log("Found property:", key, "=", typeof container[key]);
    }
  }
}

// Also check if we can access through window
console.log("\n=== Checking window for instances ===");
for (var key in window) {
  if (key.toLowerCase().includes('preload') || key.toLowerCase().includes('control')) {
    console.log("Found on window:", key);
  }
}

////////////////////////////////////////////
// Try to manually call getParameters
console.log("=== Manual getParameters Test ===");

// Get all divs with our classes
var customContainer = document.querySelector('.custom-prompt-page-container');

if (customContainer && customContainer.__data__) {
  console.log("Found __data__:", customContainer.__data__);
}

// Try to find the control through parent elements
var cognosControl = document.querySelector('[specname="customControl"]');
if (cognosControl) {
  console.log("Cognos control element found");
  
  // Check all properties
  Object.keys(cognosControl).forEach(function(key) {
    var val = cognosControl[key];
    if (val && typeof val === 'object' && val.constructor) {
      console.log("Property:", key, "Constructor:", val.constructor.name);
      
      // Check if it has getParameters
      if (typeof val.getParameters === 'function') {
        console.log("✅✅✅ FOUND getParameters on:", key);
        console.log("Calling it manually...");
        try {
          var result = val.getParameters();
          console.log("Manual call result:", result);
        } catch(e) {
          console.error("Manual call failed:", e);
        }
      }
    }
  });
}
